<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hilton Heat Registration Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .nav-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #ddd;
        }
        .nav-tab {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        .nav-tab.active {
            border-bottom-color: #007cba;
            background: #f8f9fa;
            color: #007cba;
        }
        .nav-tab:hover {
            background: #f8f9fa;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f9f9f9;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 14px;
        }
        button {
            background: #007cba;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #005a87;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .loading {
            text-align: center;
            margin: 20px 0;
            color: #666;
        }
        .error {
            background: #ffe6e6;
            border: 1px solid #ff9999;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            color: #d32f2f;
        }
        .success {
            background: #e6ffe6;
            border: 1px solid #99ff99;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            color: #2e7d32;
        }
        .info {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .status-pending { color: #f57c00; }
        .status-invited { color: #1976d2; }
        .status-registered { color: #388e3c; }
        .status-rejected { color: #d32f2f; }
        .status-yes { color: #388e3c; font-weight: bold; }
        .status-no { color: #d32f2f; font-weight: bold; }
        .status-maybe { color: #f57c00; font-weight: bold; }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .card {
            background: white;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        .card h3 {
            margin-top: 0;
            color: #007cba;
        }
        .file-upload {
            border: 2px dashed #ddd;
            padding: 40px;
            text-align: center;
            border-radius: 6px;
            margin: 20px 0;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        .file-upload:hover {
            border-color: #007cba;
        }
        .file-upload.dragover {
            border-color: #007cba;
            background: #f0f8ff;
        }
        .hidden { display: none; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }
        .stat-card.warning {
            background: #fff3cd;
            border-color: #ffeaa7;
        }
        .stat-card.danger {
            background: #f8d7da;
            border-color: #f5c6cb;
        }
        .stat-card.success {
            background: #d4edda;
            border-color: #c3e6cb;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hilton Heat Registration Management</h1>
        <p>Manage tryout registrations, team assignments, and player invitations</p>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('teams')">Teams</button>
            <button class="nav-tab" onclick="showTab('registrations')">Registrations</button>
            <button class="nav-tab" onclick="showTab('evaluations')">Evaluations</button>
            <button class="nav-tab" onclick="showTab('invitations')">Invitations</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content active">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalRegistrations">0</div>
                    <div class="stat-label">Total Registrations</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-number" id="pendingEvaluations">0</div>
                    <div class="stat-label">Pending Evaluations</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-number" id="sentInvitations">0</div>
                    <div class="stat-label">Sent Invitations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="registeredPlayers">0</div>
                    <div class="stat-label">Registered Players</div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Quick Actions</h3>
                    <button onclick="showTab('registrations')">Import Registrations</button>
                    <button onclick="showTab('evaluations')">Import Evaluations</button>
                    <button onclick="exportRegistrations()">Export Registration Data</button>
                </div>
                <div class="card">
                    <h3>Recent Activity</h3>
                    <div id="recentActivity">
                        <p>Loading recent activity...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Teams Tab -->
        <div id="teams-tab" class="tab-content">
            <div class="form-section">
                <h3>Create New Team</h3>
                <div class="form-group">
                    <label for="teamName">Team Name:</label>
                    <input type="text" id="teamName" placeholder="e.g., U12 Boys Red">
                </div>
                <div class="form-group">
                    <label for="ageGroup">Age Group:</label>
                    <select id="ageGroup">
                        <option value="">Select Age Group</option>
                        <option value="U8">U8</option>
                        <option value="U9">U9</option>
                        <option value="U10">U10</option>
                        <option value="U11">U11</option>
                        <option value="U12">U12</option>
                        <option value="U13">U13</option>
                        <option value="U14">U14</option>
                        <option value="U15">U15</option>
                        <option value="U16">U16</option>
                        <option value="U17">U17</option>
                        <option value="U18">U18</option>
                        <option value="U19">U19</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="season">Season:</label>
                    <select id="season">
                        <option value="">Select Season</option>
                        <option value="Fall 2024">Fall 2024</option>
                        <option value="Spring 2025">Spring 2025</option>
                        <option value="Fall 2025">Fall 2025</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="coachName">Coach Name:</label>
                    <input type="text" id="coachName" placeholder="Coach's full name">
                </div>
                <div class="form-group">
                    <label for="coachEmail">Coach Email:</label>
                    <input type="email" id="coachEmail" placeholder="coach@example.com">
                </div>
                <div class="form-group">
                    <label for="maxPlayers">Max Players (default 18):</label>
                    <input type="number" id="maxPlayers" value="18" min="1" max="50">
                </div>
                <button onclick="createTeam()">Create Team</button>
            </div>

            <div id="teamsList">
                <h3>Existing Teams</h3>
                <div id="teamsTable">
                    <p>Loading teams...</p>
                </div>
            </div>
        </div>

        <!-- Registrations Tab -->
        <div id="registrations-tab" class="tab-content">
            <!-- TeamSnap API Import Section -->
            <div class="form-section">
                <h3>Import from TeamSnap API</h3>
                <p>Sync tryout registrations directly from TeamSnap using their API.</p>

                <div class="form-group">
                    <label for="teamsnapTeam">TeamSnap Division/Team:</label>
                    <input type="text" id="teamsnapTeam" placeholder="Enter TeamSnap division (e.g., 973808/division_teams)">
                </div>

                <div class="form-group">
                    <label for="teamsnapSeason">Season (optional):</label>
                    <select id="teamsnapSeason">
                        <option value="">Auto-detect</option>
                        <option value="Fall 2024">Fall 2024</option>
                        <option value="Spring 2025">Spring 2025</option>
                        <option value="Fall 2025">Fall 2025</option>
                    </select>
                </div>

                <button onclick="loadTeamSnapTeams()">Test Connection</button>
                <button onclick="syncTeamSnapRegistrations()">Get Registrations</button>
            </div>

            <!-- File Import Section -->
            <div class="form-section">
                <h3>Import from File</h3>
                <p>Upload a CSV or Excel file with tryout registration data from TeamSnap or manual entry.</p>

                <div class="form-group">
                    <label for="registrationSeason">Season:</label>
                    <select id="registrationSeason">
                        <option value="">Select Season</option>
                        <option value="Fall 2024">Fall 2024</option>
                        <option value="Spring 2025">Spring 2025</option>
                        <option value="Fall 2025">Fall 2025</option>
                    </select>
                </div>

                <div class="file-upload" onclick="document.getElementById('registrationFile').click()">
                    <p>Click to select or drag and drop your registration file</p>
                    <p><em>Supported formats: CSV, Excel (.xlsx, .xls)</em></p>
                    <input type="file" id="registrationFile" accept=".csv,.xlsx,.xls" style="display: none">
                </div>

                <div id="registrationFileName" class="hidden">
                    <p>Selected file: <span id="registrationFileNameText"></span></p>
                    <button onclick="importRegistrations()">Import Registrations</button>
                    <button onclick="clearRegistrationFile()">Clear</button>
                </div>
            </div>

            <div id="registrationsTable">
                <h3>Registration Overview</h3>
                <div class="form-group">
                    <label for="filterAgeGroup">Filter by Age Group:</label>
                    <select id="filterAgeGroup" onchange="loadRegistrations()">
                        <option value="">All Age Groups</option>
                        <option value="U8">U8</option>
                        <option value="U9">U9</option>
                        <option value="U10">U10</option>
                        <option value="U11">U11</option>
                        <option value="U12">U12</option>
                        <option value="U13">U13</option>
                        <option value="U14">U14</option>
                        <option value="U15">U15</option>
                        <option value="U16">U16</option>
                        <option value="U17">U17</option>
                        <option value="U18">U18</option>
                        <option value="U19">U19</option>
                    </select>
                </div>
                <div id="registrationsContent">
                    <p>Select filters and click "Load Registrations" to view data</p>
                </div>
            </div>
        </div>

        <!-- Evaluations Tab -->
        <div id="evaluations-tab" class="tab-content">
            <div class="form-section">
                <h3>Import Coach Evaluations</h3>
                <p>Upload the CSV file with coach evaluations (completed registration spreadsheet).</p>

                <div class="form-group">
                    <label for="evaluationTeam">Team:</label>
                    <select id="evaluationTeam">
                        <option value="">Select Team</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="evaluatedBy">Evaluated By:</label>
                    <input type="text" id="evaluatedBy" placeholder="Coach or evaluator name">
                </div>

                <div class="file-upload" onclick="document.getElementById('evaluationFile').click()">
                    <p>Click to select or drag and drop your evaluation file</p>
                    <p><em>CSV file with "Invite" column containing "yes", "no", or "maybe"</em></p>
                    <input type="file" id="evaluationFile" accept=".csv" style="display: none">
                </div>

                <div id="evaluationFileName" class="hidden">
                    <p>Selected file: <span id="evaluationFileNameText"></span></p>
                    <button onclick="importEvaluations()">Import Evaluations</button>
                    <button onclick="clearEvaluationFile()">Clear</button>
                </div>
            </div>
        </div>

        <!-- Invitations Tab -->
        <div id="invitations-tab" class="tab-content">
            <div class="form-section">
                <h3>Create Invitations</h3>
                <p>Create and send personalized invitation emails to selected players.</p>

                <div class="form-group">
                    <label for="invitationTeam">Team:</label>
                    <select id="invitationTeam">
                        <option value="">Select Team</option>
                    </select>
                </div>

                <div id="playersForInvitation">
                    <p>Select a team to see players available for invitation</p>
                </div>

                <div id="invitationActions" class="hidden">
                    <button onclick="createInvitations()">Create Invitations</button>
                    <button onclick="sendInvitations()">Send All Invitations</button>
                </div>
            </div>

            <div id="invitationsTable">
                <h3>Pending Invitations</h3>
                <div id="invitationsContent">
                    <p>No pending invitations</p>
                </div>
            </div>
        </div>

        <!-- Loading and Messages -->
        <div id="loading" class="loading hidden">
            <p>Processing...</p>
        </div>

        <div id="error" class="error hidden">
            <p id="errorMsg"></p>
        </div>

        <div id="success" class="success hidden">
            <p id="successMsg"></p>
        </div>
    </div>

    <script src="/js/hilton-heat.js"></script>
</body>
</html>
